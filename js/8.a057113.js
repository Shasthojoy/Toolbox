(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[8],{"0QMv":function(t,e,i){},a9U1:function(t,e,i){"use strict";var s=i("y86T"),o=i.n(s);o.a},nONl:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",[i("virtual-scroll-list",{ref:"scrollList",attrs:{cols:t.cols,actions:t.actions,items:t.messages,date:t.from,mode:t.mode,viewConfig:t.viewConfig,colsConfigurator:"toolbar",i18n:t.i18n,filter:t.filter,theme:t.theme,title:"Messages"},on:{"change:filter":t.filterChangeHandler,"change:pagination-next":t.paginationNextChangeHandler,"change:mode":t.modeChange,"update:cols":t.updateColsHandler},scopedSlots:t._u([{key:"items",fn:function(e){var s=e.item,o=e.index,n=e.actions,c=e.cols,a=e.etcVisible,r=e.actionsVisible,l=e.itemHeight,m=e.rowWidth;return i("messages-list-item",{key:""+JSON.stringify(s)+o,attrs:{item:s,index:o,actions:n,cols:c,itemHeight:l,rowWidth:m,etcVisible:a,actionsVisible:r,selected:o===t.selected},on:{action:t.actionHandler,"item-click":t.viewMessagesHandler}})}}])})],1)},o=[],n=(i("ls82"),i("yXPU")),c=i.n(n),a=i("3kWr"),r=i("Kw5r"),l=i("9JDm"),m=i("75Vb"),u=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{style:{height:t.itemHeight+"px",width:t.rowWidth+"px"}},[t.item["__connectionStatus"]||t.item["x-flespi-filter-prev"]||t.item["x-flespi-filter-next"]?t.item["x-flespi-filter-prev"]||t.item["x-flespi-filter-next"]?i("div",{style:{height:t.itemHeight+"px",width:t.rowWidth+"px",color:"#000",fontWeight:"bold",backgroundColor:t.item["x-flespi-filter-prev"]?"#819002":"#ccb300",overflow:"hidden"}},[i("span",{staticClass:"uppercase text-white",staticStyle:{padding:"0 5px"}},[t._v(t._s(t.item["x-flespi-filter-next"]?'Next results will be filtered by: "'+t.item["x-flespi-filter-next"]+'"':'Filter removed: "'+t.item["x-flespi-filter-prev"]+'"'))])]):i("div",{style:{height:t.itemHeight+"px",width:t.rowWidth+"px",border:"solid 1px #000",color:"#000",fontWeight:"bold",backgroundColor:"offline"===t.item.__connectionStatus?"#ff0":"#0f0",backgroundImage:"url(./statics/police.png)",overflow:"hidden",opacity:".7"},attrs:{title:t.date.formatDate(1e3*t.item.timestamp,"DD/MM/YYYY HH:mm:ss")}},t._l(Array(10),function(e){return i("span",{key:e,staticClass:"uppercase",staticStyle:{padding:"0 5px","margin-left":"150px"},style:{backgroundColor:"offline"===t.item.__connectionStatus?"#ff0":"#0f0"}},[t._v(t._s(t.item["__connectionStatus"]))])})):i("div",{staticClass:"cursor-pointer",class:[t.item.__status?"missed-items":""],style:{height:t.itemHeight+"px",width:t.rowWidth+"px",backgroundColor:t.selected?"rgba(255,255,255,0.7)":"",color:t.selected?"#333":""},on:{click:function(e){t.itemClickHandler(t.index,t.item)}}},[t.actionsVisible?i("span",{staticClass:"list__item item_actions"},t._l(t.actions,function(e,s){return i("q-icon",{key:s,staticClass:"cursor-pointer on-left",class:e.classes,attrs:{name:e.icon},nativeOn:{click:function(i){i.stopPropagation(),t.clickHandler(t.index,e.type,t.item)}}},[i("q-tooltip",[t._v(t._s(e.label))])],1)})):t._e(),t._l(t.cols,function(e,s){return i("span",{key:e.name+s,staticClass:"list__item",class:(o={},o["item_"+s]=!0,o),style:{color:t.item["x-flespi-filter-fields"]&&t.item["x-flespi-filter-fields"].includes(e.name)?"#4caf50":""},attrs:{title:t.values[e.name].value}},[t._v("\n    "+t._s(t.values[e.name].value)+"\n  ")]);var o}),t.etcVisible?i("span",{staticClass:"list__item item_etc"},[t._v("\n    "+t._s(t.values.etc.value||"*Empty*")+"\n  ")]):t._e()],2)])},f=[],d=i("lSNA"),h=i.n(d),p=i("cDf5"),g=i.n(p),v=(i("KKXr"),i("yt8O"),i("RW0V"),i("rGqo"),i("f3/d"),{props:["item","index","actions","cols","itemHeight","etcVisible","rowWidth","actionsVisible","selected"],data:function(){return{date:l["d"]}},computed:{values:function(){var t=this,e=this.cols.reduce(function(t,e,i,s){return t[e.name]={value:null},i===s.length-1&&(t.etc={value:""}),t},{});return Object.keys(this.item).forEach(function(i){if(-1!==i.indexOf("#")){var s=i.split("#"),o=s[0],n=s[1];if(e[o]){if(e[o].value){if("object"!==g()(e[o].value)){var c=e[o].value;e[o].value=h()({},n-1,c)}}else e[o].value={};e[o].value[n]=JSON.stringify(t.item[i])}else e.etc.value+="".concat(i,": ").concat(JSON.stringify(t.item[i]),"; ")}else if(e[i]){var a=t.item[i];-1!==i.indexOf("timestamp")&&(a=l["d"].formatDate(1e3*a,"DD/MM/YYYY HH:mm:ss")),-1!==i.indexOf("image.bin.")&&(a="<binary image>"),e[i].value=JSON.stringify(a)}else{if("__status"===i||"x-flespi-filter-fields"===i||"x-flespi-filter-next"===i||"x-flespi-filter-prev"===i)return!1;e.etc.value+="".concat(i,": ").concat(JSON.stringify(t.item[i]),"; ")}}),Object.keys(e).forEach(function(t){if("object"===g()(e[t].value)&&e[t].value)if(e[t].value instanceof Array){var i=e[t].value.reduce(function(t,e,i,s){return t+=e,i!==s.length-1&&(t+=", "),t},"");e[t].value=i}else if(e[t].value instanceof Object){var s=Object.keys(e[t].value).reduce(function(i,s,o,n){return i+="".concat(s,": ").concat(e[t].value[s]),o!==n.length-1&&(i+=", "),i},"");e[t].value=s}}),e}},methods:{clickHandler:function(t,e,i){this.$emit("action",{index:t,type:e,content:i})},itemClickHandler:function(t,e){this.$emit("item-click",{index:t,content:e})}}}),x=v,N=(i("a9U1"),i("KHd+")),$=Object(N["a"])(x,u,f,!1,null,null,null),_=$.exports,y={props:["mode","date","activeId","limit","config"],data:function(){return{theme:this.config.theme,i18n:{},viewConfig:this.config.viewConfig,actions:this.config.actions,moduleName:this.config.vuexModuleName}},computed:{messages:{get:function(){var t=this.$store.state[this.moduleName].messages;return this.setTranslation(t),1===this.mode?t:this.filterMessages(this.filter,t)},set:function(t){this.$store.commit("".concat(this.moduleName,"/setMessages"),t)}},active:{get:function(){return this.$store.state[this.moduleName].active},set:function(){var t=c()(regeneratorRuntime.mark(function t(e){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,this.$store.dispatch("".concat(this.moduleName,"/unsubscribePooling"));case 2:return this.$store.commit("".concat(this.moduleName,"/setActive"),e),i=this.$store.state.items.filter(function(t){return e===t.id})[0]||{},r["default"].set(this.config.viewConfig,"needShowEtc",i.protocol_name&&("http"===i.protocol_name||"mqtt"===i.protocol_name)),t.next=7,this.$store.dispatch("".concat(this.moduleName,"/getCols"));case 7:this.modeChange(this.mode),this.$store.dispatch("".concat(this.moduleName,"/pollingGet"));case 9:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},cols:{get:function(){return this.$store.state[this.moduleName].cols},set:function(t){this.$store.commit("".concat(this.moduleName,"/updateCols"),t)}},filter:{get:function(){return this.$store.state[this.moduleName].filter},set:function(t){t?this.$store.commit("".concat(this.moduleName,"/setFilter"),t):this.$store.commit("".concat(this.moduleName,"/setFilter"),"")}},from:{get:function(){return this.$store.state[this.moduleName].from},set:function(t){t?this.$store.commit("".concat(this.moduleName,"/setFrom"),t):this.$store.commit("".concat(this.moduleName,"/setFrom"),0)}},to:{get:function(){return this.$store.state[this.moduleName].to},set:function(t){t?this.$store.commit("".concat(this.moduleName,"/setTo"),t):this.$store.commit("".concat(this.moduleName,"/setTo"),0)}},currentLimit:{get:function(){return this.$store.state[this.moduleName].limit},set:function(t){t?this.$store.commit("".concat(this.moduleName,"/setLimit"),t):this.$store.commit("".concat(this.moduleName,"/setLimit"),1e3)}},selected:{get:function(){return this.$store.state[this.moduleName].selected},set:function(t){this.$store.commit("".concat(this.moduleName,"/setSelected"),t)}}},methods:{resetParams:function(){this.$refs.scrollList.resetParams()},filterChangeHandler:function(t){this.filter!==t&&(this.filter=t)},setTranslation:function(t){this.i18n.to=t.length?"Next batch from ".concat(l["d"].formatDate(1e3*this.from,"HH:mm:ss")):"Next"},modeChange:function(t){switch(t=+t,this.$store.commit("".concat(this.moduleName,"/clearMessages")),this.$store.commit("".concat(this.moduleName,"/setMode"),t),t){case 0:this.active&&this.$store.dispatch("".concat(this.moduleName,"/get"));break}},updateColsHandler:function(t){this.cols=t},paginationNextChangeHandler:function(){this.$store.dispatch("".concat(this.moduleName,"/get"))},actionHandler:function(t){var e=t.index,i=t.type,s=t.content;switch(i){case"view":this.viewMessagesHandler({index:e,content:s});break;case"copy":this.copyMessageHandler({index:e,content:s});break}},viewMessagesHandler:function(t){var e=t.index,i=t.content;this.selected=e,this.$emit("view-data",i)},copyMessageHandler:function(t){var e=this,i=(t.index,t.content);this.$copyText(JSON.stringify(i)).then(function(t){e.$q.notify({type:"positive",icon:"content_copy",message:"Message copied",timeout:1e3})},function(t){e.$q.notify({type:"negative",icon:"content_copy",message:"Error coping messages",timeout:1e3})})},unselect:function(){this.selected&&(this.selected=null)}},watch:{activeId:function(t){this.active=t},mode:function(t){this.modeChange(t)},limit:function(t){this.currentLimit=t}},created:function(){var t=c()(regeneratorRuntime.mark(function t(){var e,i=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.$store.state[this.moduleName]?this.$store.commit("".concat(this.moduleName,"/clear")):this.$store.registerModule(this.moduleName,Object(a["b"])({Vue:r["default"],LocalStorage:this.$q.localStorage,name:this.moduleName,errorHandler:function(t){i.$store.commit("reqFailed",t)},filterHandler:this.filterMessages})),this.currentLimit=this.limit,!this.activeId){t.next=8;break}return this.$store.commit("".concat(this.moduleName,"/setActive"),this.activeId),e=this.$store.state.items.filter(function(t){return i.activeId===t.id})[0]||{},r["default"].set(this.config.viewConfig,"needShowEtc",e.protocol_name&&("http"===e.protocol_name||"mqtt"===e.protocol_name)),t.next=8,this.$store.dispatch("".concat(this.moduleName,"/getCols"));case 8:null===this.$store.state[this.moduleName].mode&&(this.modeChange(this.mode),this.$store.dispatch("".concat(this.moduleName,"/pollingGet"))),r["default"].connector.socket.on("offline",function(){1===i.mode&&(i.$store.commit("".concat(i.moduleName,"/setOffline"),1===i.mode),i.$store.commit("setSocketOffline",!0))}),r["default"].connector.socket.on("connect",function(){i.$store.state[i.moduleName].offline&&(i.$store.commit("".concat(i.moduleName,"/setReconnected"),1===i.mode),i.$store.commit("setSocketOffline",!1))});case 11:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),destroyed:function(){r["default"].connector.socket.off("offline"),r["default"].connector.socket.off("connect"),this.$store.commit("".concat(this.moduleName,"/clear"))},mixins:[m["a"]],components:{VirtualScrollList:a["a"],MessagesListItem:_}},b=y,w=(i("r4WM"),Object(N["a"])(b,s,o,!1,null,null,null));e["default"]=w.exports},r4WM:function(t,e,i){"use strict";var s=i("0QMv"),o=i.n(s);o.a},y86T:function(t,e,i){}}]);